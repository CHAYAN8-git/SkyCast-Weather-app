<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SkyCast</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center transition-all duration-500">

  <!-- Search -->
  <div class="w-full max-w-md px-4 mb-8">
    <div class="flex bg-white rounded-xl shadow-md px-4 py-3 items-center">
      <input
        id="cityInput"
        type="text"
        placeholder="Search city..."
        class="flex-1 outline-none text-gray-600"
      />
      <button id="searchBtn" class="text-gray-500 hover:text-black">
        üîç
      </button>
    </div>
  </div>

  <!-- Main Card -->
  <div class="w-full max-w-3xl bg-white rounded-3xl shadow-xl p-8 flex flex-col md:flex-row justify-between items-center gap-8">

    <div>
      <h2 id="cityName" class="text-gray-500 text-lg">City</h2>

      <h1 id="temperature" class="text-7xl font-extralight tracking-tight text-gray-800 mt-2">
        --¬∞
      </h1>

      <p id="description" class="text-gray-400 mt-2 capitalize">Condition</p>

      <div class="flex gap-10 mt-8 text-gray-500 text-sm">
        <div>
          <p class="font-medium">Humidity</p>
          <p id="humidity">--%</p>
        </div>
        <div>
          <p class="font-medium">Wind</p>
          <p id="wind">-- m/s</p>
        </div>
      </div>
    </div>

    <div>
      <img id="icon" src="" class="w-28 h-28" />
    </div>

  </div>

<script>
const apiKey = "5611a0dc4b3e04d30ba6c020de5d0e53";

const searchBtn = document.getElementById("searchBtn");
const cityInput = document.getElementById("cityInput");

searchBtn.addEventListener("click", getWeather);
cityInput.addEventListener("keydown", function(e) {
  if (e.key === "Enter") {
    getWeather();
  }
});

async function getWeather() {
  const city = cityInput.value.trim();

  if (!city) {
    alert("Enter city name");
    return;
  }

  document.getElementById("temperature").innerText = "Loading...";

  try {
    const response = await fetch(
      `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric`
    );

    const data = await response.json();
    console.log(data);

    if (data.cod !== 200) {
      alert(data.message);
      return;
    }

    updateUI(data);

  } catch (error) {
    console.error(error);
    alert("Error fetching data");
  }
}

function updateUI(data) {

  document.getElementById("cityName").innerText = data.name;
  document.getElementById("temperature").innerText =
    Math.round(data.main.temp) + "¬∞C";
  document.getElementById("description").innerText =
    data.weather[0].description;
  document.getElementById("humidity").innerText =
    data.main.humidity + "%";
  document.getElementById("wind").innerText =
    data.wind.speed + " m/s";

  // New working icon link
  const iconCode = data.weather[0].icon;
  document.getElementById("icon").src =
    `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

  updateBackground(data.weather[0].main.toLowerCase());
}

function updateBackground(condition) {

  const base = "min-h-screen flex flex-col items-center justify-center transition-all duration-500";

  if (condition.includes("cloud")) {
    document.body.className =
      "bg-gradient-to-br from-gray-200 to-gray-400 " + base;
  } 
  else if (condition.includes("rain")) {
    document.body.className =
      "bg-gradient-to-br from-blue-200 to-blue-400 " + base;
  } 
  else if (condition.includes("clear")) {
    document.body.className =
      "bg-gradient-to-br from-yellow-100 to-orange-200 " + base;
  } 
  else if (condition.includes("snow")) {
    document.body.className =
      "bg-gradient-to-br from-blue-100 to-white " + base;
  } 
  else {
    document.body.className =
      "bg-gray-100 " + base;
  }
}
</script>

</body>
</html>